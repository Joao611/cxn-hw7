---
title: "HW 7"
author: "Alicja Dutkiewicz, Irina Gurewitsch, Jo√£o Esteves"
date: "02/11/2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(igraph)
library(purrr)
library(data.table)
```

## Exercise 1

#### (1)

```{r}
# Safer version of sample, fixes results for length 1
resample <- function(x, ...) x[sample.int(length(x), ...)]

genConfModel <- function(degs) {
  edges <- list()
  
  repeat {
    # Find unconnected stubs
    non_zero_inds <- which(degs > 0)
    if (length(non_zero_inds) < 2 & length(which(degs >= 2)) == 0) {
      break
    }
  
    # Randomly pick a stub
    stub1_ind <- resample(non_zero_inds, 1)
    # s <- append(s, stub1_ind)
    degs[stub1_ind] <- degs[stub1_ind] - 1
  
    # Randomly pick a stub to connect the previous one to
    non_zero_inds <- which(degs > 0)
    stub2_ind <- resample(non_zero_inds, 1)
    # t <- append(t, stub2_ind)
    degs[stub2_ind] <- degs[stub2_ind] - 1
    
    edges <- append(edges, list(list(stub1_ind, stub2_ind)))
  }
  
  links <- data.frame(t(sapply(edges, c)))
    # source=s,
    # target=t
    # )
  return (links)
}
```

#### (2)

TODO

#### (3)

```{r}
degs1 <- c(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)
degs2 <- c(7, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1)
```

| k1 self-loops | k2 self-loops | k1 repeated edges | k2 repeated edges |
|---------------|---------------|-------------------|-------------------|
| 4             | 3             | 0                 | 3                 |
| 1             | 3             | 4                 | 3                 |
| 1             | 2             | 0                 | 0                 |
| 1             | 1             | 0                 | 3                 |
| 1             | 2             | 2                 | 3                 |
| 0             | 3             | 0                 | 2                 |
| 0             | 1             | 2                 | 3                 |
| 1             | 3             | 4                 | 2                 |
| 0             | 4             | 4                 | 4                 |
| 0             | 2             | 2                 | 2                 |
| 1             | 2             | 0                 | 4                 |
| 0             | 1             | 0                 | 2                 |
| 0             | 3             | 0                 | 2                 |
| 1             | 3             | 4                 | 3                 |
| 1             | 3             | 0                 | 2                 |
| 2             | 2             | 0                 | 2                 |
| 1             | 5             | 0                 | 3                 |
| 2             | 2             | 0                 | 2                 |
| 0             | 4             | 2                 | 3                 |
| 1             | 2             | 0                 | 2                 |
| 0             | 3             | 0                 | 2                 |
| 1             | 1             | 6                 | 2                 |
| 2             | 1             | 0                 | 2                 |
| 1             | 4             | 0                 | 3                 |
| 0             | 2             | 0                 | 4                 |
| 1             | 3             | 0                 | 4                 |
| 0             | 2             | 0                 | 4                 |
| 1             | 2             | 4                 | 4                 |
| 1             | 3             | 0                 | 2                 |
| 0             | 3             | 0                 | 5                 |

The average number of self-loops in k1 is 0.83 while for k2 it's 2.5. The average number of repeated edges in k1 is 1.13 while for k2 it's 2.73.

## Exercise 2

```{r}
genRepConfModel <- function(degs) {
  s <- c()
  t <- c()
  
  repeat {
    # Find unconnected stubs
    non_zero_inds <- which(degs > 0)
    if (length(non_zero_inds) < 2 & length(which(degs >= 2)) == 0) {
      break
    }
  
    # Randomly pick a stub
    stub1_ind <- resample(non_zero_inds, 1)
    s <- append(s, stub1_ind)
    degs[stub1_ind] <- degs[stub1_ind] - 1
  
    # Randomly pick a stub to connect the previous one to
    non_zero_inds <- which(degs > 0)
    stub2_ind <- resample(non_zero_inds, 1)
    t <- append(t, stub2_ind)
    degs[stub2_ind] <- degs[stub2_ind] - 1
  }
  
  links <- data.frame(
    source=s,
    target=t
    )
  return (links)
}
```

## Exercise 3



## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
# plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
